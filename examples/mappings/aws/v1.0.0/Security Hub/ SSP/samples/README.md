
# Event Dossier: Amazon Security Hub Finding

### Amazon Security Hub Compliance Analyzer Result to OSCAL
- **Description**: Translates Amazon Security Hub Compliance Analyzer Result to OSCAL System Security Plan (SSP) Schema.
- **Event References**:
    - [NIST OSCAL Site](https://pages.nist.gov/OSCAL/)
    - [OSCAL System Security Plan JSON Schema](https://pages.nist.gov/OSCAL-Reference/models/v1.1.2/system-security-plan/json-reference/)
    - [OSCAL GitHub Repository](https://github.com/usnistgov/OSCAL)
    - [NIST SP 800-53 Rev 5] (https://csrc.nist.rip/CSRC/media/Projects/risk-management/800-53%20Downloads/800-53r5/NIST_SP-800-53_rev5_catalog_load.csv)

# Transforming Compliance Control Information to OSCAL System Security Plan (SSP) Schema

This document provides a detailed mapping and example for transforming compliance finding information into the OSCAL System Security Plan (SSP) model.

## OSCAL Version: 1.1.2

- **Document Metadata:**
  - `metadata.version`: `1.1.2`
  - `metadata.title`: `AWS NIST 800-53 Operational Best Practices Baseline`
  - `metadata.last-modified`: `2024-06-19T13:47:35.456796Z`
  - `metadata.oscal-version`: `1.1.2`

## System Security Plan JSON Structure

```json
{
  "system-security-plan": {
    "uuid": "ebbf9534-784c-4d26-9f4c-59f08f4527e2",
    "import-profile": {
      "href": "profile-uuid"
    },
    "metadata": {
      "title": "AWS NIST 800-53 Operational Best Practices Baseline",
      "last-modified": "2024-06-19T13:47:35.456796Z",
      "oscal-version": "1.1.2",
      "version": "1.1.2"
    },
    "system-characteristics": {
      "system-name": "AWS",
      "description": "Mission Owner Environment",
      "security-sensitivity-level": "moderate",
      "system-information": {
        "information-types": [
          {
            "title": "web app",
            "description": "web application"
          }
        ]
      },
      "system-ids": [
        {
          "id": "111111111111"
        }
      ],
      "status": {
        "state": "operational"
      },
      "authorization-boundary": {
        "description": ""
      }
    },
    "system-implementation": {
      "users": [
        {
          "uuid": "123e4567-e89b-42d3-a456-426614174000",
          "title": "ac-4",
          "description": "planned"
        }
      ],
      "props": [
        {
          "name": "users-internal",
          "ns": "https://fedramp.gov/ns/oscal",
          "value": "1200"
        }
      ],
      "components": [
        {
          "uuid": "123e4567-e89b-42d3-a456-426614174000",
          "type": "this-system",
          "title": "Cloud Resources and Services",
          "description": "The system described by this SSP. This text was auto-generated by the OSCAL M3-RC1 data upgrade converter.",
          "status": {
            "state": "operational"
          }
        }
      ]
    },
    "control-implementation": {
      "description": "",
      "implemented-requirements": [
        {
          "uuid": "44a521d3-8eca-530f-b078-6163ca677900",
          "control-id": "ac-4",
          "remarks": "Cloud resources and services will be configured in accordance with AWS NIST SP 800-53 Operational Best Practices and EC2.15, S3.2, Lambda.1, EC2.30, SSM.4, Opensearch.3, EC2.13, Lambda.3, S3.8, EC2.9, Opensearch.8, EC2.18, S3.3, EC2.1, EC2.2, EC2.29, Opensearch.2, S3.5, S3.1, RDS.1 to best align with NIST SP 800-53 control AC-4",
          "props": [
            {
              "name": "implementation-status",
              "ns": "https://fedramp.gov/ns/oscal",
              "value": "planned"
            }
          ],
          "statements": [
            {
              "statement-id": "ac-4-21",
              "uuid": "f3887a91-9ed3-425c-b305-21e4634a1c34",
              "by-components": [
                {
                  "component-uuid": "795533ab-9427-4abe-820f-0b571bacfe6d",
                  "uuid": "a74681b2-fbcb-46eb-90fd-0d55aa74ac7b",
                  "description": "The information system separates information flows logically or physically using [Assignment: organization-defined mechanisms and/or techniques] to accomplish [Assignment: organization-defined required separations by types of information]."
                }
              ]
            }
          ]
        }
      ]
    }
  }
}
```

## Mapping CSV Fields to OSCAL SSP Schema

The following table outlines the mapping from the CSV fields to the corresponding OSCAL SSP fields:

| CSV Field                  | OSCAL SSP Field                                                                |
|----------------------------|--------------------------------------------------------------------------------|
| `compliance_control_id`    | `control-implementation.implemented-requirements[].control-id`                 |
| `percentage`               | `control-implementation.implemented-requirements[].remarks`                    |
| `rule_id`                  | `control-implementation.implemented-requirements[].statements[*].description`  |
| `lastobservedat`           | `metadata.last-modified`                                                       |

## Additional Required Data

The following data is required for the OSCAL SSP but cannot be derived directly from the CSV:

| Data Field                          | Description                                                                                   |
|-------------------------------------|-----------------------------------------------------------------------------------------------|
| `system-name`                       | The name of the system being documented.                                                      |
| `system-characteristics.description`| A detailed description of the system.                                                         |
| `security-sensitivity-level`        | The sensitivity level of the system (e.g., low, moderate, high).                              |
| `import-profile.href`               | The URL or reference to the import profile.                                                   |
| `authorization-boundary.description`| A description of the system's authorization boundary.                                         |
| `components[].uuid`                 | A unique identifier for each system component.                                                |
| `components[].type`                 | The type of each system component (e.g., software, hardware).                                 |
| `components[].title`                | The title or name of each system component.                                                   |
| `components[].description`          | A detailed description of each system component.                                              |
| `components[].status.state`         | The operational status of each system component (e.g., operational, under-development).       |
| `statements`                        | A list of statements associated with the system components.                                   |
| `statement-id`                      | The unique identifier for each statement.                                                     |
| `by-components[].component-uuid`    | The unique identifier of the component related to the statement.                              |
| `by-components[].uuid`              | The unique identifier for each `by-component` association.                                    |
| `by-components[].description`       | A detailed description of the `by-component` association.                                     |

Example of `statements` structure:

```json
{
  "statement-id": "ac-4-21",
  "uuid": "f3887a91-9ed3-425c-b305-21e4634a1c34",
  "by-components": [
    {
      "component-uuid": "795533ab-9427-4abe-820f-0b571bacfe6d",
      "uuid": "a74681b2-fbcb-46eb-90fd-0d55aa74ac7b",
      "description": "The information system separates information flows logically or physically using [Assignment: organization-defined mechanisms and/or techniques] to accomplish [Assignment: organization-defined required separations by types of information]."
    }
  ]
}
```
